{% extends "admin/base.html" %}

{% block title %}Edit Program{% endblock %}
{% block page_title %}Edit Program{% endblock %}
{% block page_subtitle %}Update program details and save changes.{% endblock %}

{% block topbar_actions %}
<a href="/admin/programs" class="btn btn-secondary">Back to Programs</a>
{% endblock %}

{% block content %}
<section class="admin-card" style="max-width: 980px;">
    <div class="card-head">
        <div>
            <strong>{{ program.name }}</strong>
            <div class="muted">Edit details, status, and timings</div>
        </div>
    </div>
    <div class="card-body">
        <form method="POST" enctype="multipart/form-data">
            <div class="admin-form-grid">
                <div class="form-group">
                    <label for="name">Program Name *</label>
                    <input type="text" id="name" name="name" value="{{ program.name }}" required>
                </div>
                <div class="form-group">
                    <label for="category">Category</label>
                    <select id="category" name="category">
                        <option value="">Select Category</option>
                        <option value="Child" {% if program.category == 'Child' %}selected{% endif %}>Child — 6th Sense Development</option>
                        <option value="Pregnant Women" {% if program.category == 'Pregnant Women' %}selected{% endif %}>Pregnant Women — Garbhasanskar</option>
                        <option value="Relaxation" {% if program.category == 'Relaxation' %}selected{% endif %}>Relaxation & Healing</option>
                        <option value="Inner Journey" {% if program.category == 'Inner Journey' %}selected{% endif %}>Inner Journey</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="type">Type *</label>
                    <select id="type" name="type" required>
                        <option value="online" {% if program.type == 'online' %}selected{% endif %}>Online</option>
                        <option value="offline" {% if program.type == 'offline' %}selected{% endif %}>Offline</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="date">Date *</label>
                    <input type="date" id="date" name="date" value="{{ program.date.strftime('%Y-%m-%d') }}" required>
                </div>
                <div class="form-group">
                    <label for="start_time">Start Time *</label>
                    <input type="time" id="start_time" name="start_time"
                           value="{% if program.start_time %}{{ program.start_time.strftime('%H:%M') }}{% endif %}"
                           required>
                </div>
                <div class="form-group">
                    <label for="end_time">End Time *</label>
                    <input type="time" id="end_time" name="end_time"
                           value="{% if program.end_time %}{{ program.end_time.strftime('%H:%M') }}{% endif %}"
                           required>
                </div>
                <div class="form-group">
                    <label for="time">Time Display</label>
                    <input type="text" id="time" name="time" value="{{ program.time }}" readonly>
                    <small class="admin-help">Auto-updated when you change Start/End time.</small>
                </div>
                <div class="form-group">
                    <label for="status">Status</label>
                    <select id="status" name="status">
                        <option value="active" {% if program.status == 'active' %}selected{% endif %}>Active</option>
                        <option value="completed" {% if program.status == 'completed' %}selected{% endif %}>Completed</option>
                        <option value="cancelled" {% if program.status == 'cancelled' %}selected{% endif %}>Cancelled</option>
                    </select>
                </div>

                <div class="form-group span-2">
                    <label for="photo">Photo</label>
                    {% if program.photo %}
                    <div style="margin: 8px 0 14px 0;">
                        <img src="{{ url_for('static', filename=program.photo) }}" alt="Current photo" style="max-width: 260px; border-radius: 14px; border: 1px solid rgba(15, 23, 42, 0.12);">
                    </div>
                    {% endif %}
                    <input type="file" id="photo" name="photo" accept="image/*">
                    <small class="admin-help">Leave empty to keep the current photo.</small>
                </div>

                <div class="form-group span-2">
                    <label for="description">Description *</label>
                    <textarea id="description" name="description" rows="6" required>{{ program.description }}</textarea>
                </div>
            </div>

            <div class="admin-actions" style="margin-top: 20px;">
                <button type="submit" class="btn btn-primary">Update Program</button>
                <a href="/admin/programs" class="btn btn-secondary">Cancel</a>
            </div>
        </form>
    </div>
</section>
{% endblock %}

